<div class="pagination-container">
  <!-- Page Navigation -->
  <div class="pagination-nav">
    <button class="btn-pagination-arrow" (click)="rewind()" [disabled]="pag!.isFirst" title="Página anterior">
      <i class="bi bi-chevron-left"></i>
    </button>

    <div class="pagination-numbers">
      <span *ngFor="let p of pag!.totalPages; let i=index; let isLast=last; let isFirst=first">
        <!-- Menos de 9 páginas: mostrar todas -->
        <span *ngIf="pag!.totalPages.length < pag!.listPagesLimits + 5">
          <button
            class="btn-page"
            (click)="setPage(i)"
            [class.active]="i === pag!.page"
            [title]="'Ir a página ' + (i+1)">
            {{ i + 1 }}
          </button>
        </span>

        <!-- Más de 9 páginas: mostrar inteligentemente -->
        <span *ngIf="pag!.totalPages.length >= pag!.listPagesLimits + 5">
          <!-- Primeras páginas -->
          <span *ngIf="pag!.page <= pag!.listPagesLimits">
            <button
              *ngIf="i <= pag!.listPagesLimits"
              class="btn-page"
              (click)="setPage(i)"
              [class.active]="i === pag!.page"
              [title]="'Ir a página ' + (i+1)">
              {{ i + 1 }}
            </button>
            <span *ngIf="isLast">
              <span class="pagination-ellipsis">...</span>
              <button
                class="btn-page"
                (click)="setPage(i)"
                [class.active]="i === pag!.page"
                [title]="'Ir a página ' + (i+1)">
                {{ i + 1 }}
              </button>
            </span>
          </span>

          <!-- Páginas intermedias -->
          <span *ngIf="pag!.page > pag!.listPagesLimits && pag!.page < pag!.totalPages.length - pag!.listPagesLimits">
            <span *ngIf="isFirst">
              <button
                class="btn-page"
                (click)="setPage(i)"
                [class.active]="i === pag!.page"
                [title]="'Ir a página ' + (i+1)">
                {{ i + 1 }}
              </button>
              <span class="pagination-ellipsis">...</span>
            </span>
            <button
              *ngIf="i < pag!.page + pag!.listPagesLimits && i > pag!.page - pag!.listPagesLimits"
              class="btn-page"
              (click)="setPage(i)"
              [class.active]="i === pag!.page"
              [title]="'Ir a página ' + (i+1)">
              {{ i + 1 }}
            </button>
            <span *ngIf="isLast">
              <span class="pagination-ellipsis">...</span>
              <button
                class="btn-page"
                (click)="setPage(i)"
                [class.active]="i === pag!.page"
                [title]="'Ir a página ' + (i+1)">
                {{ i + 1 }}
              </button>
            </span>
          </span>

          <!-- Últimas páginas -->
          <span *ngIf="pag!.page >= pag!.totalPages.length - pag!.listPagesLimits">
            <span *ngIf="isFirst">
              <button
                class="btn-page"
                (click)="setPage(i)"
                [class.active]="i === pag!.page"
                [title]="'Ir a página ' + (i+1)">
                {{ i + 1 }}
              </button>
              <span class="pagination-ellipsis">...</span>
            </span>
            <button
              *ngIf="i >= pag!.totalPages.length - pag!.listPagesLimits"
              class="btn-page"
              (click)="setPage(i)"
              [class.active]="i === pag!.page"
              [title]="'Ir a página ' + (i+1)">
              {{ i + 1 }}
            </button>
          </span>
        </span>
      </span>
    </div>

    <button class="btn-pagination-arrow" (click)="forward()" [disabled]="pag!.isLast" title="Página siguiente">
      <i class="bi bi-chevron-right"></i>
    </button>
  </div>

  <!-- Page Size Selector -->
  <div class="pagination-size">
    <label class="size-label">Mostrar</label>
    <select class="size-select" [(ngModel)]="pag!.size" (change)="setSize(pag!.size)">
      <option [value]="10">10</option>
      <option [value]="15">15</option>
      <option [value]="25">25</option>
      <option [value]="50">50</option>
      <option [value]="pag!.sizeLimit" *ngIf="pag!.sizeLimit > 50">{{ pag!.sizeLimit }}</option>
    </select>
    <span class="size-label">por página</span>
  </div>
</div>
